{% extends "auth_base.html" %}
{% load static i18n %}
{% load socialaccount %}

{% block content %}
<div class="container d-flex justify-content-center align-items-center min-vh-100 my-3">
  <div class="card login-card p-4" style="max-width: 420px; width: 100%;">

    <!-- Logo -->
    <div class="text-center mb-4">
      <img src="{% static 'img/logo.png' %}" alt="{% trans 'Logo' %}" class="img-fluid mx-auto" style="max-height: 120px;">
    </div>
    
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{% if message.tags == 'error' %}danger{% else %}{{ message.tags }}{% endif %} alert-dismissible fade show m-3" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
      {% endfor %}
    {% endif %}

    <!-- Title -->
    <h4 class="text-center fw-bold mb-3">
      <i class="bi bi-shield-lock-fill text-dark"></i> {% trans "Sign In" %}
    </h4>
    <p class="text-muted text-center mb-4">{% trans "Welcome back! Please login to your account." %}</p>


    <!-- Login Form -->
    <form method="post" novalidate>
      {% csrf_token %}

      {{ form.non_field_errors }}
      <div class="mb-3">
        <label for="id_login" class="form-label">{% trans "Email" %}</label>
        {{ form.login }}
        {{ form.login.errors }}
      </div>
      <div class="mb-3">
        <label for="id_password" class="form-label">{% trans "Password" %}</label>
        {{ form.password }}
        {{ form.password.errors }}
      </div>
      
      <button type="submit" class="btn btn-custom-primary w-100 rounded-3 mb-3">
        <i class="bi bi-box-arrow-in-right"></i> {% trans "Login" %}
      </button>
    </form>

    <!-- OR divider -->
    <div class="text-center my-3 text-muted">— {% trans "OR" %} —</div>

    <!-- Microsoft Login -->
    <a href="{% provider_login_url 'microsoft' %}" 
       class="btn btn-outline-dark w-100 rounded-3 d-flex align-items-center justify-content-center gap-2">
      <i class="bi bi-microsoft"></i> {% trans "Sign in with Microsoft" %}
    </a>

    <!-- reset password link -->
    <div class="text-center mt-3">
      <a href="{% url 'password_reset' %}" class="small text-decoration none">{% trans "Forgot Password?" %}</a>
    </div>

  </div>
</div>
{% endblock %}
